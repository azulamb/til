# 4方向

## 乱数からの方向

rが0-4(上右下左)で来たとき、xとyにそれぞれ+1か-1をする。具体的には以下のような対応関係。

| r | x | y |意味|
|---|---|---|----|
| 0 | x |y-1| 上 |
| 1 |x+1| y | 右 |
| 2 | x |y+1| 下 |
| 3 |x-1| y | 左 |

```
x + ( 2 - r ) * ( r % 2 )
y + ( r - 1 ) * ( ( r + 1 ) % 2 ) )
```

## キャラの方向

上下左右の入力から、0-3の方向番号に変換するやつ。8方向も入れておくか

どこかに処理があったので引っ張ってくる

# 8方向

```
 1
8 2
 4
```

このようなbitが立つとすると、以下になる。

```
 9 1 3
 8   2
12 4 6
```

## 方向の数字からxとyを分離

例えば3なら、`x=1`、`y=-1`に分離する

なお3方向の場合などは上下などのセット部分を無効化して残った値になる。つまり15は全方向入力なので0になる。

```
sx = floor( direction < 8 ? ( direction % 4 ) / 2 : ( direction % 4 ) / 2  - 1  );
sy = ( direction % 8 ) < 4 ? -( direction % 2 ) : ( direction + 1 ) % 2;
```

floorは小数点以下切り捨て関数。整数が使えるなら不要。
