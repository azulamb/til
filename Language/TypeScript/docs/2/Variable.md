# 結論

変数宣言に使う優先度は `const` >>> `let` >>>>>>>>越えられない壁>>>>>>>> `var`

# 変数

JavaScriptの変数は以下のように宣言して使います。

```
let test = "Test string!!";
console.log( test );
test = 1;
console.log( test );
```

`console.log( 表示したいデータもしくは変数 )` で画面に文字を出力してくれます。
結果は次のようになります。

```
Test string!!
1
```

`let` が変数の宣言に使われるもので、`let 変数名` で変数を宣言できます。
JavaScriptでは宣言されてない変数や定義されていない関数をそのまま使おうとするとエラーになります。

```
// これだけだとエラー
console.log( test );
```

型についての話でも述べますが、JavaScriptの変数には何でも入れることが出来ます。

# スコープ

JavaScriptの変数の宣言は以下3種類です。

* `var`
    * 再代入可能。関数スコープ。
* `let`
    * 再代入可能。ブロックスコープ。
* `const`
    * 再代入不可能。ブロックスコープ。
    
JavaScriptの変数には何でも入れることができるので、差異は違変数に値を再代入可能かどうかと、その変数が参照できる範囲=スコープの違いのみとなります。

## var

元々のJavaScriptにある唯一の変数を宣言するキーワードでした。

よくある変数にあるように値を再代入できます。

```
// 数値を入れる変数
var num = 0;
// 別に後から文字列を代入しても良い
num = 'test';
```

ただ、このスコープがかなり特殊です。

まずは普通のパターン。

```
var global = 1;

function func() {
    // これはローカル変数として使われるので、上のglobalとは別物
    var global = 3;
    console.log( 'func:', global );
}

console.log( global );
++global;
func();
console.log( global );
```

結果は以下です。

```
1
func: 3
2
```

では次のようなケースはどうでしょう？

```
console.log( i );

for ( var i = 0 ; i < 5 ; ++i ) { console.log( i ); }
```

結果は以下です。

```
undefined
0
1
2
3
4
```

何故かエラーになりません。

JavaScriptの場合、`var` は関数スコープで、宣言した場合関数の一番始めで宣言された状態になります。なので上のコードは以下と等価です。

```
var i;

console.log( i );

for ( i = 0 ; i < 5 ; ++i ) { console.log( i ); }
```

iという変数はあるが、中身には何も入れていないので、undefinedという結果をまず出力し、後はループ文では開始時に0を代入されたのでそこから演算をしています。

## letとconst

一方最近のJavaScriptには新しい変数の宣言として `let` と `const` が追加されました。

```
console.log( i );

for ( let i = 0 ; i < 5 ; ++i ) { console.log( i ); }
```

こちらのコードですが、普通にエラーになります。
`let` と `const` はブロックがスコープなので、`i` はforループの中でのみ有効です。

このように変数のスコープが分かりやすくなっているので、基本的には `let` と `const` を使うようにしましょう。

## const

では、constは何のためにあるのか？
一応効果では再代入不可能となっています。

```
const pi = 3.14;
pi = 3;
```

この場合次のようなエラーが発生します。

```
pi = 3;
   ^

TypeError: Assignment to constant variable.
```

このように初回以外の代入はすべてエラーとなるため、定数などの宣言に使うことが推奨されます。

……っと言いたいところですが、こちら、基本は `const` を使うようにしましょう。

理由としては、再代入により型が変わったり使い方が変わることで、バグの温床になりかねないからです。
逆に言えば、`const` で宣言された変数は今後変な値を代入されることはないため、デバッグの助けになります。

そのため、基本的に変数はすべて `const` で宣言し、どうしてもループで使いたいなどの時に限り `let` を使うようにします。

とりあえず `let` と `const` があれば必ず `var` を使わなければならない状況というものは基本ないので、`var` は使わないようにしましょう。
4年以上使ってますが、一度も `var` じゃないと無理なコードを書いたことはありません。

何度も書きますが、基本は `const` のみ使い、どうしても再代入必要な変数だけ `let` にして、本当に `var` でなければ動かないコードの時のみ `var` を使うようにしましょう。
