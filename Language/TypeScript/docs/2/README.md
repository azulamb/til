# JavaScriptの基礎

TypeScriptはJavaScript＋その型に関する知識が必要なので、初めての方向けに大雑把に必要な知識をまとめていきます。

# JavaScriptの型

JavaScriptには見えないものの型が存在しています。
その型は大体以下になります。


```
// 数値
console.log( typeof 1 );

// 文字列
console.log( typeof '' );

// 真偽値
console.log( typeof true );

// undefined
console.log( typeof undefined );

// null
console.log( typeof null );

// 配列
console.log( typeof [] );

// オブジェクト
console.log( typeof {} );

// 関数
console.log( typeof function(){} );

// クラス
console.log( typeof class{} );
```

結果は以下です。

```
number    // 数値
string    // 文字列
boolean   // 真偽値
undefined // undefined
object    // null
object    // 配列
object    // オブジェクト
function  // 関数
function  // クラス
```

Why? ってなるような所も多いと思います。そこが生のJSを使っている時に辛いところです。
例えば配列であることを調べたいのに、`typeof` とかいう型を調べてくれそうなやつを使っても、結果は `object` になるわけです。だいぶ辛いです。

とりあえず、JavaScriptでは大まかには上に出ている `number`, `string`, `boolean`, `undefined`, `object`, `function` が基本的な型となります。

## 補足

JavaScriptはクラスベースのオブジェクト指向型言語ではなく、プロトタイプベースのオブジェクト指向型言語です。

クラスベースの場合、オブジェクトには明確な型がありますが、柔軟性はなく、それに柔軟性を持たせるために継承を使います。

一方プロトタイプベースの場合は、汎用的なオブジェクトに対し、任意の値、任意のメソッドを生やすことで柔軟性をもたせています。

配列は、例えばlengthがあるとか、0から増えるキーに対して値が入っているとか、配列操作用のメソッドがあるみたいな条件を満たしたオブジェクトを配列として扱っているようなイメージで動作します。
そのため、通常の方法ではある変数が変数かオブジェクトかの判断をするのはかなり難易度が高いです。

ただし、相当古いブラウザを対象としない限り、`Array.isArray( 変数 )` を使うことで配列かどうか判定することが出来ます。

このような特殊な型の判定はTypeScriptでは基本必要ないのですが、JavaScriptとの境界線やユーザーや外部からの入力の境界線付近で必要となります。

# 型が曖昧な場合に起こりうるバグ

上のような型のバグはまだわかりやすいのですが、例えば `parseInt` にまつわるバグはかなり根深かったりします。

`parseInt( 文字列, 進数の指定 )` は与えられた文字列を第二引数の進数で解釈して返す挙動なので、以下のような挙動になります。

```
console.log( parseInt( '1' ) );
console.log( parseInt( '0.0000009' ) );
console.log( parseInt( 0.0000009 ) );
```

結果は以下です。

```
1
0
9
```

9……？なぜ？

文字列の1を整数に直せば1です。
文字列の0.0000009を整数に直せば小数点以下を無視して0です。

では、なぜ数値の0.0000009を整数にすると9になるのか。

その答えは以下です。

```
console.log( 0.0000009.toString() );
console.log( parseInt( 0.0000009.toString() ) );
console.log( parseInt( 0.0000009 ) );
```

結果は以下です。

```
9e-7
9
9
```

`paraseInt` は第一引数に与えられた変数が文字列であることを前提としています。
数値を与えた場合、文字列に変換してから処理が行われます。

結果`、0.0000009` を文字列にした場合 `9e-7` となり、この文字列を整数に変換する場合、9までは認識して、次の文字が数値ではないのでそこで変換を終了し、9という結果を返します。

このように、JavaScriptは見えないからといって型を無視するわけにはいきません。
それっぽく動いても動かないケースというものが存在します。
